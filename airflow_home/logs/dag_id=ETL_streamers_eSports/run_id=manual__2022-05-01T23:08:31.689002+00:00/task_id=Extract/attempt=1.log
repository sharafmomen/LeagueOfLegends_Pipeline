[2022-05-01 23:08:37,411] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: ETL_streamers_eSports.Extract manual__2022-05-01T23:08:31.689002+00:00 [queued]>
[2022-05-01 23:08:37,488] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: ETL_streamers_eSports.Extract manual__2022-05-01T23:08:31.689002+00:00 [queued]>
[2022-05-01 23:08:37,488] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-05-01 23:08:37,488] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2022-05-01 23:08:37,488] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-05-01 23:08:37,604] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): Extract> on 2022-05-01 23:08:31.689002+00:00
[2022-05-01 23:08:37,608] {standard_task_runner.py:52} INFO - Started process 24284 to run task
[2022-05-01 23:08:37,611] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'ETL_streamers_eSports', 'Extract', 'manual__2022-05-01T23:08:31.689002+00:00', '--job-id', '22', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp2vfv9l04', '--error-file', '/tmp/tmpxbxqv5zq']
[2022-05-01 23:08:37,612] {standard_task_runner.py:80} INFO - Job 22: Subtask Extract
[2022-05-01 23:08:37,916] {task_command.py:369} INFO - Running <TaskInstance: ETL_streamers_eSports.Extract manual__2022-05-01T23:08:31.689002+00:00 [running]> on host cube-14ce9f9c-b3e2-4031-af90-157b53c1fe85-669c6656fd-gv56j
[2022-05-01 23:08:38,389] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=ETL_streamers_eSports
AIRFLOW_CTX_TASK_ID=Extract
AIRFLOW_CTX_EXECUTION_DATE=2022-05-01T23:08:31.689002+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-05-01T23:08:31.689002+00:00
[2022-05-01 23:08:38,862] {logging_mixin.py:115} INFO - Total number of players in EU server:  103
[2022-05-01 23:10:05,924] {taskinstance.py:1889} ERROR - Task failed with exception
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/opt/anaconda/envs/Python3/lib/python3.8/concurrent/futures/process.py", line 239, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
  File "/project/airflow_home/dags/custom_package/extract_funcs.py", line 90, in last_match_key
    frame = pd.DataFrame({'account_name':l1, 'region':l2, 'DT_RowId': tpp_ids})
  File "/opt/anaconda/envs/Python3/lib/python3.8/site-packages/pandas/core/frame.py", line 529, in __init__
    mgr = init_dict(data, index, columns, dtype=dtype)
  File "/opt/anaconda/envs/Python3/lib/python3.8/site-packages/pandas/core/internals/construction.py", line 287, in init_dict
    return arrays_to_mgr(arrays, data_names, index, columns, dtype=dtype)
  File "/opt/anaconda/envs/Python3/lib/python3.8/site-packages/pandas/core/internals/construction.py", line 80, in arrays_to_mgr
    index = extract_index(arrays)
  File "/opt/anaconda/envs/Python3/lib/python3.8/site-packages/pandas/core/internals/construction.py", line 401, in extract_index
    raise ValueError("arrays must all be same length")
ValueError: arrays must all be same length
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda/envs/Python3/lib/python3.8/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/opt/anaconda/envs/Python3/lib/python3.8/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/project/airflow_home/dags/etl_dag.py", line 54, in extract
    last_matches = extract_funcs.multi_processing(focused_streamers)
  File "/project/airflow_home/dags/custom_package/extract_funcs.py", line 108, in multi_processing
    to_be_concat.append(g.result())
  File "/opt/anaconda/envs/Python3/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/opt/anaconda/envs/Python3/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
ValueError: arrays must all be same length
[2022-05-01 23:10:06,006] {taskinstance.py:1395} INFO - Marking task as FAILED. dag_id=ETL_streamers_eSports, task_id=Extract, execution_date=20220501T230831, start_date=20220501T230837, end_date=20220501T231006
[2022-05-01 23:10:06,130] {standard_task_runner.py:92} ERROR - Failed to execute job 22 for task Extract (arrays must all be same length; 24284)
[2022-05-01 23:10:06,187] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-05-01 23:10:06,441] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
